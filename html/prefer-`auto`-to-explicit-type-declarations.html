<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.3 (452849)"/><meta name="keywords" content="auto, C++, C++11, C++14"/><meta name="created" content="2015-10-18 14:45:21 +0000"/><meta name="updated" content="2015-10-19 08:35:04 +0000"/><title>Prefer `auto` to explicit type declarations.</title></head><body>
<!-- Sublime:LS0tCnRpdGxlOiBQcmVmZXIgYGF1dG9gIHRvIGV4cGxpY2l0IHR5cGUgZGVjbGFyYXRpb25zLgpub3RlYm9vazogQysrCnRhZ3M6QysrLCBDKysxMSwgQysrMTQsIGF1dG8KLS0tCgpCZXNpZGVzIHRoZSBncmVhdGx5IHJlZHVjZWQgbnVtYmVyIG9mIGNoYXJhY3RlcnMgd2hlbiBzcGVjaWZ5aW5nIHR5cGVzLCBgYXV0b2AgaGFzIGZvdXIgbWFpbiBiZW5lZml0cywgbGlzdGVkIGJlbG93LiBEbyBub3RlIHRoZSBkaXNjcmVwYW5jeSB3aXRoIGluaXRpYWxpemVycyBsaXN0cyBmb3IgYGF1dG9gLCB0aG91Z2guCgojIyBgYXV0b2AgcmVxdWlyZXMgaW5pdGlhbGl6YXRpb24KCk9mdGVuLCBpdCBtYXkgaGF2ZSBvY2N1cnJlZCB0aGF0IHlvdSB3YW50ZWQgdG8gZGVjbGFyZSBhbiBpbnRlZ2VyIGFuZCB1c2UgaXQgcmlnaHQgYXdheToKCmBgYEMrKwppbnQgeDsKCmZvciAoaW50IGkgPSAwOyBpIDwgTjsgKytpKSArK3g7CmBgYAoKVGhlIHByb2JsZW0gaXMgdGhhdCBgeGAsIGhlcmUsIG1heSBub3QgaGF2ZSBiZWVuIGluaXRpYWxpemVkIGNvcnJlY3RseS4gTW9yZSBwcmVjaXNlbHksIGl0IGlzIGRlZmF1bHQtaW5pdGlhbGl6ZWQsIG5vdCB2YWx1ZS1pbml0aWFsaXplZCwgbWVhbmluZyBpdCAqY2FuKiBjb250YWluIHplcm8sIGJ1dCBpdCBjYW4ganVzdCBhcyB3ZWxsIGNvbnRhaW4gYW55IGhvcnJpYmxlIGdhcmJhZ2UgdmFsdWUuCgpgYXV0b2AgcmVxdWlyZXMgZGlyZWN0IGluaXRpYWxpemF0aW9uLCBzbyB5b3UgY2Fubm90IGZvcmdldCB0byBpbml0aWFsaXplIHRoZSB2YXJpYWJsZSBhbnkgbG9uZ2VyOgoKYGBgQysrCmF1dG8geCA9IDA7Cgpmb3IgKGludCBpID0gMDsgaSA8IE47ICsraSkgKyt4OwpgYGAKCiMjIEJldHRlciBwb3J0YWJpbGl0eSBhbmQgbW9yZSBleGFjdCB0eXBlcwoKU29tZXRpbWVzLCB5b3UgbWF5IHdhbnQgdG8gc3RvcmUgYSB2YWx1ZSB0aGF0IHlvdSB0aGluayB3aWxsIG5vdCBiZSB0aGF0IGhpZ2ggaW4gYW4gaW50ZWdlciBvZiBsb3dlciBiaXR3aWR0aDoKCmBgYEMrKwp1bnNpZ25lZCBzaXplID0gY29udGFpbmVyLnNpemUoKTsKYGBgCgpUaGlzIGlzIGZpbmUgb24gMzItYml0IHN5c3RlbXMsIGFzIHRoZXJlIGFuIGB1bnNpZ25lZCBpbnRgIGFuZCBhbiBgdW5zaWduZWQgbG9uZ2AgKHdoaWNoIGlzIGFueSBgc3RkOjpjb250YWluZXI8VD46OnNpemVfdHlwZWApIGFyZSBib3RoIDMyLWJpdC4gSG93ZXZlciwgb24gNjQtYml0IHN5c3RlbXMgeW91IGNvdWxkIGhhdmUgc2VyaW91cyBwb3J0YWJpbGl0eSBpc3N1ZXMgYXMgdGhlIGBzdGQ6OmNvbnRhaW5lcjxUPjo6c2l6ZV90eXBlYCB3b3VsZCBiZSA2NC1iaXQgd2hpbGUgdGhlIGB1bnNpZ25lZCBpbnRgIHJlbWFpbnMgMzItYml0LiBUaHVzLCBqdXN0IHVzZSBgc3RkOjpzaXplX3RgIG9yIGBhdXRvYDoKCmBgYEMrKwphdXRvIHNpemUgPSBjb250YWluZXIuc2l6ZSgpOwpgYGAKClRvIGRlY2lkZSBiZXR3ZWVlbiBgc3RkOjpzaXplX3RgIGFuZCBgYXV0b2AsIEkgd291bGQgc2F5IHVzZSBgYXV0b2AgZm9yIHJldHVybi12YWx1ZXMgYW5kIGBzdGQ6OnNpemVfdGAgZm9yIGRlY2xhcmF0aW9ucyAoZS5nLiBgc3RkOjpzaXplX3QgeCA9IDBgKSwgYXMgYXV0byB3aWxsIGluaXRpYWxpemUgYW4gYGludGAgd2hpbGUgeW91IG1heSBub3QgbmVlZCB0aGUgbmVnYXRpdmUgdmFsdWVzIGFuZCBhbHNvIGEgZ3JlYXRlciBwb3NpdGl2ZSByYW5nZS4KCiMjIEZld2VyIHR5cGUgbWlzbWF0Y2hlcwoKVHlwZSBtaXNtYXRjaGVzIGhhcHBlbmQsIGNvbnNpZGVyIHRoaXMgY2FzZToKCmBgYEMrKwovLyBBbHNvIHZhbGlkIGZvciB1bm9yZGVyZWRfbWFwLCBzZXQgYW5kIHVub3JkZXJlZF9zZXQKc3RkOjptYXA8c3RkOjpzaXplX3QsIHN0ZDo6c3RyaW5nPiBtYXA7Cgpmb3IgKGNvbnN0IHN0ZDo6cGFpcjxzdGQ6OnNpemVfdCwgc3RkOjpzdHJpbmc+JiBwYWlyIDogbWFwKQp7CgkvKiAuLi4gKi8KfQpgYGAKClRoZSBwcm9ibGVtIGhlcmUgaXMgdGhhdCB0aGUgcGFpciByZXR1cm5lZCBieSBgc3RkOjptYXBgIG9yIGFueSBvdGhlciBhc3NvY2lhdGl2ZSBjb250YWluZXIgaGFzIGl0cyBrZXkgYGNvbnN0YCwgaS5lLiBoZXJlIHRoZSB0eXBlIHlvdSBnZXQgZnJvbSBkZXJlZmVuY2luZyBhbiBgc3RkOjptYXA6Oml0ZXJhdG9yYCBpcyBhY3R1YWxseSBgc3RkOjpwYWlyPGNvbnN0IHN0ZDo6c2l6ZV90LCBzdGQ6OnN0cmluZz5gIChub3RlIHRoZSBgY29uc3RgIGZvciB0aGUga2V5KS4gVGhpcyB3aWxsIGNvbXBpbGUsIGhvd2V2ZXIgdGhlIHBhaXIgeW91IGdldCB3aWxsIGJlIGEgY29weSBvZiB0aGUgb3JpZ2luYWwgcGFpciwgd2hpY2ggaXMgbGVzcyBlZmZpY2llbnQuIFlvdSBjb3VsZCBoYXZlIGF2b2lkZWQgdGhpcyB0eXBlLW1pc21hdGNoIGJ5IHVzaW5nIGBhdXRvYDoKCmBgYEMrKwpzdGQ6Om1hcDxzdGQ6OnNpemVfdCwgc3RkOjpzdHJpbmc+IG1hcDsKCmZvciAoY29uc3QgYXV0byYgcGFpciA6IG1hcCkKewoJLyogLi4uICovCn0KYGBgCgojIyBHcmVhdGVyIG1haW50YWluYWJpbGl0eQoKVGhlbiB0aGVyZSBpcyBhbHNvIG1haW50YWluYWJpbHR5LiBBdCB0aGUgc3RhcnQgb2YgeW91ciBuZXcgcHJvamVjdCwgeW91IG1heSB0aGluayBgZm9vYCB3aWxsIHJldHVybiBhIHJhdyBwb2ludGVyOgoKYGBgQysrCmludCogcHRyID0gZm9vKCk7CmBgYAoKQnV0IHRoZW4geW91IGJlY29tZSBzbWFydGVyIGFuZCBoYXZlIGl0IHJldHVybiBhbiBgc3RkOjp1bmlxdWVfcHRyYC4gVGhlIGNvZGUgYWJvdmUgd291bGQgdGhlbiBmYWlsLCB1c2luZyBgYXV0b2Agd291bGQgaGF2ZSBhZGp1c3RlZCB0byB0aGlzICpkaXJlY3RseSosIGkuZS4gbWFpbnRhaW5lZCBpdCAqZm9yIHlvdSo6CgoKYGBgQysrCmF1dG8gcHRyID0gZm9vKCk7CmBgYA==-->
<p>Besides the greatly reduced number of characters when specifying types, <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">auto</code> has four main benefits, listed below. Do note the discrepancy with initializers lists for <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">auto</code>, though.</p>

<h2><code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">auto</code> requires initialization</h2>

<p>Often, it may have occurred that you wanted to declare an integer and use it right away:</p>

<pre title="C++" style="color: #000000; font-family: monospace,monospace; font-size: 0.9em; white-space: pre-wrap; word-wrap: break-word; border: 1px solid #cccccc; border-radius: 3px; overflow: auto; padding: 6px 10px; margin-bottom: 10px;background-color:#ffffff;"><code style="color: black; font-family: monospace,monospace; font-size: 0.9em;"><span style="color: #AA0D92">int</span> <span style="color: #000000">x</span>;

<span style="color: #AA0D92">for</span> (<span style="color: #AA0D92">int</span> <span style="color: #000000">i</span> <span style="color: #000000">=</span> <span style="color: #2300CE">0</span>; <span style="color: #000000">i</span> <span style="color: #000000">&lt;</span> <span style="color: #000000">N</span>; <span style="color: #000000">++i</span>) <span style="color: #000000">++x</span>;
</code></pre>

<p>The problem is that <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">x</code>, here, may not have been initialized correctly. More precisely, it is default-initialized, not value-initialized, meaning it <em>can</em> contain zero, but it can just as well contain any horrible garbage value.</p>

<p><code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">auto</code> requires direct initialization, so you cannot forget to initialize the variable any longer:</p>

<pre title="C++" style="color: #000000; font-family: monospace,monospace; font-size: 0.9em; white-space: pre-wrap; word-wrap: break-word; border: 1px solid #cccccc; border-radius: 3px; overflow: auto; padding: 6px 10px; margin-bottom: 10px;background-color:#ffffff;"><code style="color: black; font-family: monospace,monospace; font-size: 0.9em;"><span style="color: #AA0D92">auto</span> <span style="color: #000000">x</span> <span style="color: #000000">=</span> <span style="color: #2300CE">0</span>;

<span style="color: #AA0D92">for</span> (<span style="color: #AA0D92">int</span> <span style="color: #000000">i</span> <span style="color: #000000">=</span> <span style="color: #2300CE">0</span>; <span style="color: #000000">i</span> <span style="color: #000000">&lt;</span> <span style="color: #000000">N</span>; <span style="color: #000000">++i</span>) <span style="color: #000000">++x</span>;
</code></pre>

<h2>Better portability and more exact types</h2>

<p>Sometimes, you may want to store a value that you think will not be that high in an integer of lower bitwidth:</p>

<pre title="C++" style="color: #000000; font-family: monospace,monospace; font-size: 0.9em; white-space: pre-wrap; word-wrap: break-word; border: 1px solid #cccccc; border-radius: 3px; overflow: auto; padding: 6px 10px; margin-bottom: 10px;background-color:#ffffff;"><code style="color: black; font-family: monospace,monospace; font-size: 0.9em;"><span style="color: #AA0D92">unsigned</span> <span style="color: #000000">size</span> <span style="color: #000000">=</span> <span style="color: #000000">container</span>.<span style="color: #000000">size</span>();
</code></pre>

<p>This is fine on 32-bit systems, as there an <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">unsigned int</code> and an <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">unsigned long</code> (which is any <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">std::container&lt;T&gt;::size_type</code>) are both 32-bit. However, on 64-bit systems you could have serious portability issues as the <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">std::container&lt;T&gt;::size_type</code> would be 64-bit while the <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">unsigned int</code> remains 32-bit. Thus, just use <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">std::size_t</code> or <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">auto</code>:</p>

<pre title="C++" style="color: #000000; font-family: monospace,monospace; font-size: 0.9em; white-space: pre-wrap; word-wrap: break-word; border: 1px solid #cccccc; border-radius: 3px; overflow: auto; padding: 6px 10px; margin-bottom: 10px;background-color:#ffffff;"><code style="color: black; font-family: monospace,monospace; font-size: 0.9em;"><span style="color: #AA0D92">auto</span> <span style="color: #000000">size</span> <span style="color: #000000">=</span> <span style="color: #000000">container</span>.<span style="color: #000000">size</span>();
</code></pre>

<p>To decide betweeen <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">std::size_t</code> and <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">auto</code>, I would say use <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">auto</code> for return-values and <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">std::size_t</code> for declarations (e.g. <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">std::size_t x = 0</code>), as auto will initialize an <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">int</code> while you may not need the negative values and also a greater positive range.</p>

<h2>Fewer type mismatches</h2>

<p>Type mismatches happend, consider this case:</p>

<pre title="C++" style="color: #000000; font-family: monospace,monospace; font-size: 0.9em; white-space: pre-wrap; word-wrap: break-word; border: 1px solid #cccccc; border-radius: 3px; overflow: auto; padding: 6px 10px; margin-bottom: 10px;background-color:#ffffff;"><code style="color: black; font-family: monospace,monospace; font-size: 0.9em;"><span style="color: #177500">// Also valid for unordered_map, set and unordered_set</span>
<span style="color: #000000">std::map&lt;std::</span><span style="color: #AA0D92">size_t</span>, <span style="color: #000000">std::string&gt;</span> <span style="color: #000000">map</span>;

<span style="color: #AA0D92">for</span> (<span style="color: #AA0D92">const</span> <span style="color: #000000">std::pair&lt;std::</span><span style="color: #AA0D92">size_t</span>, <span style="color: #000000">std::string&gt;&amp;</span> <span style="color: #000000">pair</span> <span style="color: #000000">:</span> <span style="color: #000000">map</span>)
{
    <span style="color: #177500">/* ... */</span>
}
</code></pre>

<p>The problem here is that the pair returned by <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">std::map</code> or any other associative container has its key <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">const</code>, i.e. here the type you get from derefencing an <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">std::map::iterator</code> is actually <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">std::pair&lt;const std::size_t, std::string&gt;</code> (note the <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">const</code> for the key). This will compile, however the pair you get will be a copy of the original pair, which is less efficient. You could have avoided this type-mismatch by using <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">auto</code>:</p>

<pre title="C++" style="color: #000000; font-family: monospace,monospace; font-size: 0.9em; white-space: pre-wrap; word-wrap: break-word; border: 1px solid #cccccc; border-radius: 3px; overflow: auto; padding: 6px 10px; margin-bottom: 10px;background-color:#ffffff;"><code style="color: black; font-family: monospace,monospace; font-size: 0.9em;"><span style="color: #000000">std::map&lt;std::</span><span style="color: #AA0D92">size_t</span>, <span style="color: #000000">std::string&gt;</span> <span style="color: #000000">map</span>;

<span style="color: #AA0D92">for</span> (<span style="color: #AA0D92">const</span> <span style="color: #AA0D92">auto</span><span style="color: #000000">&amp;</span> <span style="color: #000000">pair</span> <span style="color: #000000">:</span> <span style="color: #000000">map</span>)
{
    <span style="color: #177500">/* ... */</span>
}
</code></pre>

<h2>Greater maintainability</h2>

<p>Then there is also maintainabilty. At the start of your new project, you may think <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">foo</code> will return a raw pointer:</p>

<pre title="C++" style="color: #000000; font-family: monospace,monospace; font-size: 0.9em; white-space: pre-wrap; word-wrap: break-word; border: 1px solid #cccccc; border-radius: 3px; overflow: auto; padding: 6px 10px; margin-bottom: 10px;background-color:#ffffff;"><code style="color: black; font-family: monospace,monospace; font-size: 0.9em;"><span style="color: #AA0D92">int</span><span style="color: #000000">*</span> <span style="color: #000000">ptr</span> <span style="color: #000000">=</span> <span style="color: #000000">foo</span>();
</code></pre>

<p>But then you become smarter and have it return an <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">std::unique_ptr</code>. The code above would then fail, using <code style="color: #000000; font-family: monospace,monospace; padding: 0.1em 0.2em; margin: 0.1em; font-size: 85%; background-color: #F5F5F5; border-radius: 3px; border: 1px solid #cccccc;">auto</code> would have adjusted to this <em>directly</em>, i.e. maintained it <em>for you</em>:</p>

<pre title="C++" style="color: #000000; font-family: monospace,monospace; font-size: 0.9em; white-space: pre-wrap; word-wrap: break-word; border: 1px solid #cccccc; border-radius: 3px; overflow: auto; padding: 6px 10px; margin-bottom: 10px;background-color:#ffffff;"><code style="color: black; font-family: monospace,monospace; font-size: 0.9em;"><span style="color: #AA0D92">auto</span> <span style="color: #000000">ptr</span> <span style="color: #000000">=</span> <span style="color: #000000">foo</span>();
</code></pre>
</body></html>