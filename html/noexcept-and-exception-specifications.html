<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 6.3 (452849)"/><meta name="altitude" content="518"/><meta name="author" content="petergoldsborough@hotmail.com"/><meta name="created" content="2015-03-27 19:51:59 +0000"/><meta name="latitude" content="46.62858276367184"/><meta name="longitude" content="13.82443237304688"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2015-07-06 18:17:30 +0000"/><title>noexcept and exception specifications</title></head><body>
<div>It is possible to specify whether and what exceptions a function may throw. While a now deprecated feature, one could formerly specify exceptions of a function like so:</div>
<div><br/></div>
<div><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #e448ab">void</span> <span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures">foo()</span> <span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #e448ab">throw</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures">();<br/>
<br/></span></div>
<div><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #e448ab">void</span> <span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures">bar()</span> <span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #e448ab">throw</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures">(std::runtime_error);</span></div>
<div><span style="font-size: 11px;"><span style="font-family: Menlo;"><br/></span></span></div>
<div>However, this lead to certain problems and is thus no longer supported. Nevertheless, in C++11 you can still specify that a function will not throw any exception (nothrow guarantee):</div>
<div><span style="font-size: 11px;"><span style="font-family: Menlo;"><br/></span></span></div>
<div><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #e448ab">void</span> <span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures">foo()</span> <span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures; color: #e448ab">noexcept</span><span style="font: 11.0px Menlo; font-variant-ligatures: no-common-ligatures">;</span></div>
<div><span style="font-size: 11px;"><span style="font-family: Menlo;"><br/></span></span></div>
<div>This is not always necessary, but may lead to performance improvements (<a href="http://stackoverflow.com/questions/10787766/when-should-i-really-use-noexcept">http://stackoverflow.com/questions/10787766/when-should-i-really-use-noexcept</a>):</div>
<div><br/></div>
<div><span style="color: rgb(34, 34, 34); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); float: none;">Using </span><code style="padding: 1px 5px; border: 0px; background-color: rgb(238, 238, 238); white-space: pre-wrap; color: rgb(34, 34, 34); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-family: Georgia;">noexcept</span></code><span style="color: rgb(34, 34, 34); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); float: none;"> in the big 4 (constructors, assignment, not destructors as they'll already </span><code style="padding: 1px 5px; border: 0px; background-color: rgb(238, 238, 238); white-space: pre-wrap; color: rgb(34, 34, 34); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-family: Georgia;">noexcept</span></code><span style="color: rgb(34, 34, 34); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); float: none;">) will likely cause the best improvements as </span><code style="padding: 1px 5px; border: 0px; background-color: rgb(238, 238, 238); white-space: pre-wrap; color: rgb(34, 34, 34); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-family: Georgia;">noexcept</span></code><span style="color: rgb(34, 34, 34); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); float: none;"> checks are 'common' in template code such as in std containers. For instance, </span><code style="padding: 1px 5px; border: 0px; background-color: rgb(238, 238, 238); white-space: pre-wrap; color: rgb(34, 34, 34); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-family: Georgia;">std::vector</span></code><span style="color: rgb(34, 34, 34); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); float: none;"> won't use your class's move unless it's marked </span><code style="padding: 1px 5px; border: 0px; background-color: rgb(238, 238, 238); white-space: pre-wrap; color: rgb(34, 34, 34); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px;"><span style="font-family: Georgia;">noexcept</span></code><span style="color: rgb(34, 34, 34); font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; orphans: auto; text-align: left; text-indent: 0px; text-transform: none; white-space: normal; widows: auto; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(255, 255, 255); float: none;"> (or the compiler can deduce it otherwise).</span></div>
<div><span style="color: rgb(34, 34, 34);"><br/></span></div>
<div><font color="#222222">I’d say, use noexcept for template constructors, copy-constructors and copy-assignment operators and for <span style="font-size: 14px;"><b>move overloads (constructors/ copy-assignment operators)</b></span>.</font></div>
<div><span style="color: rgb(34, 34, 34);"><br/></span></div>
<div><span style="color: rgb(34, 34, 34);">When you overload the copy constructor and the copy assignment operator of a class for the sake of move semantics, it is very much recommended that you do the following:</span></div>
<div><span style="color: rgb(34, 34, 34);"><br/></span></div>
<ul>
<li><span style="color: rgb(34, 34, 34);">Strive to write your overloads in such a way that they cannot throw exceptions. That is often trivial, because move semantics typically do no more than exchange pointers and resource handles between two objects.</span></li>
<li><span style="color: rgb(34, 34, 34);">If you succeeded in not throwing exceptions from your overloads, then make sure to advertise that fact using the new noexcept keyword.</span></li>
</ul>
<div><span style="color: rgb(34, 34, 34);"><br/></span></div>
<div><span style="color: rgb(34, 34, 34);">If you don't do both of these things, then there is at least one very common situation where your move semantics will not be applied despite the fact that you would very much expect it: when an std::vector gets resized, you certainly want move semantics to happen when the existing elements of your vector are being relocated to the new memory block. But that won't happen unless both of 1. and 2. above are satisfied.</span></div>
<div><span style="color: rgb(34, 34, 34);"><br/></span></div>
<div><a href="http://thbecker.net/articles/rvalue_references/section_09.html">http://thbecker.net/articles/rvalue_references/section_09.html</a></div>
</body></html>